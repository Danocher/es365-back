generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       String    @id @default(uuid())
  name     String
  mail     String    @unique
  password String
  phonenum String
  company  String
  inn      String?
  bik      String?
  ogrn     String?
  client   Client[]
  manager  Manager[]
  order    Order[]
  product  Product[]
  shift    Shift[]
}

model Manager {
  id        String  @id @default(uuid())
  name      String
  phonenum  String
  hour_cost Int
  user_id   String
  user      User    @relation(fields: [user_id], references: [id])
  order     Order[]
  shift     Shift[]
}

model Client {
  id       String  @id @default(uuid())
  fullname String
  phonenum String
  bonuses  Int?
  user_id  String
  user     User    @relation(fields: [user_id], references: [id])
  order    Order[]
}

model Product {
  id       String   @id @default(uuid())
  name     String
  buy      Int
  sell     Int
  buy_date DateTime
  user_id  String
  user     User     @relation(fields: [user_id], references: [id])
  order    Order[]  @relation("OrderToProduct")
}

model Order {
  id         String    @id @default(uuid())
  manager_id String
  sum        Int
  client_id  String
  date       DateTime  @default(now())
  shift_id   String
  user_id    String
  client     Client    @relation(fields: [client_id], references: [id])
  manager    Manager   @relation(fields: [manager_id], references: [id])
  shift      Shift     @relation(fields: [shift_id], references: [id])
  user       User      @relation(fields: [user_id], references: [id])
  products   Product[] @relation("OrderToProduct")
}

model Shift {
  id         String    @id @default(uuid())
  date_start DateTime  @default(now())
  date_end   DateTime?
  manager_id String
  user_id    String
  order      Order[]
  manager    Manager   @relation(fields: [manager_id], references: [id])
  user       User      @relation(fields: [user_id], references: [id])
}
